<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendrier de Service</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; display: flex; justify-content: center; padding: 20px; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 600px; }
        h2 { color: #2c3e50; text-align: center; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { background: #3498db; color: white; padding: 12px; font-size: 0.9em; }
        td { padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-size: 0.85em; }
        tr:nth-child(even) { background: #f9f9f9; }
        .task-name { font-weight: bold; color: #2c3e50; text-align: left; background: #ecf0f1; width: 30%; }
        .highlight { color: #e67e22; font-weight: bold; }
    </style>
</head>
<body>
    <div class="card">
        <h2>Planning des Services</h2>
        <table id="scheduleTable">
            </table>
    </div>

    <script>
        // REPLACE THIS URL WITH YOUR PUBLISHED CSV URL
        const CSV_URL = "YOUR_LINK_HERE";

        async function loadSchedule() {
            const response = await fetch(https://docs.google.com/spreadsheets/d/e/2PACX-1vRie1Mw-i08aGCyxDXixxXlWeE1xRPYlPa899Wd-KOxFxgYI8lVw9ZsU7khyMFC6wcrIp2RiLO8uKcT/pub?gid=1386338118&single=true&output=csv);
            const data = await response.text();
            const rows = data.split("\n").map(row => row.split(","));
            
            let tableHTML = "";
            rows.forEach((row, index) => {
                if (row.length < 2) return;
                tableHTML += "<tr>";
                row.forEach((cell, i) => {
                    const tag = index === 0 ? "th" : "td";
                    const className = i === 0 ? "task-name" : "";
                    tableHTML += `<${tag} class="${className}">${cell.replace(/"/g, '')}</${tag}>`;
                });
                tableHTML += "</tr>";
            });
            document.getElementById("scheduleTable").innerHTML = tableHTML;
        }
        loadSchedule();
    </script>
</body>
</html>
